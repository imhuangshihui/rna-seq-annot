# 目的：用cufflink/stringtie+transdecoder跑出来的gff文件：1.gene区域的蛋白序列BUSCO值如何；2.统计注释信息，如基因的数量,mRNA,CDS,exon等等
## 1.测试gff文件中的蛋白序列BUSCO值
### 1.1 提取gene的区域并打印成bed格式(这一步很慢，建议后台脚本)
cat transdecoder.cufflink.gff3 | awk '$3=="gene"{print $1,$4,$5,$3}'| tr ' ' '\t' > transdecoder.cufflink.gene.bed
### 1.2 bed文件进行排序
bedtools sort -i transdecoder.cufflink.gene.bed > transdecoder.cufflink.gene.sort.bed
### 1.3 去除掉和TE区重合的部分，用EDTA的结果
bedtools intersect -v -a transdecoder.cufflink.gene.sort.bed -b EDTA_sort.bed > transdecoder.cufflink.gene_intersect-v.bed
### 1.4 提取蛋白序列
bedtools getfasta -fi final_v2.fa -bed v2{}_intersect-v.bed -fo v2{}_out.fa
bedtools getfasta -fi final_v2.fa -bed transdecoder.cufflink.gene_intersect-v.bed -fo cufflink_out.fa
### 1.5 计算BUSCO值
busco -m geno -i v2{}_out.fa -l /data2/wangzhiheng/BUSCO/embryophyta_odb10/ -c 40  -o v2{}_emb  --offline
busco -m geno -i cufflink_out.fa -l /data2/wangzhiheng/BUSCO/embryophyta_odb10/ -c 40 -o v2_cufflink_emb --offline


